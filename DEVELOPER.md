# Baklib MCP Server - å¼€å‘è€…æ–‡æ¡£

æœ¬æ–‡æ¡£é¢å‘æƒ³è¦å‚ä¸å¼€å‘æˆ–ä»æºç è¿è¡Œ Baklib MCP Server çš„å¼€å‘è€…ã€‚

## ğŸ› ï¸ å¼€å‘ç¯å¢ƒè®¾ç½®

### å…‹éš†ä»“åº“

```bash
git clone https://github.com/baklib/baklib-mcp-server.git
cd baklib-mcp-server
```

### å®‰è£…ä¾èµ–

```bash
npm install
```

### é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```env
# å¿…éœ€ï¼šBaklib API å¯†é’¥å¯¹
BAKLIB_TOKEN=your-api-token-here

# å¯é€‰ï¼šAPI åŸºç¡€åœ°å€ï¼ˆç§æœ‰åŒ–éƒ¨ç½²ç”¨æˆ·ä½¿ç”¨ï¼‰
# é»˜è®¤ä¸ºï¼šhttps://open.baklib.com/api/v1
BAKLIB_API_BASE=https://open.baklib.com/api/v1
```

**ç¯å¢ƒå˜é‡è¯´æ˜**ï¼š
- `BAKLIB_TOKEN`ï¼ˆå¿…éœ€ï¼‰ï¼šBaklib API å¯†é’¥å¯¹ï¼Œæ ¼å¼ä¸º `access_key:secret_key`
- `BAKLIB_API_BASE`ï¼ˆå¯é€‰ï¼‰ï¼šAPI åŸºç¡€åœ°å€
  - é»˜è®¤å€¼ï¼š`https://open.baklib.com/api/v1`
  - ç§æœ‰åŒ–éƒ¨ç½²ç”¨æˆ·å¯ä»¥é€šè¿‡æ­¤ç¯å¢ƒå˜é‡é…ç½®è‡ªå·±çš„ API åœ°å€
  - ä¾‹å¦‚ï¼š`https://your-private-domain.com/api/v1`

### è¿è¡Œ

```bash
npm start
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
baklib-mcp-server/
â”œâ”€â”€ index.js                    # MCP æœåŠ¡å™¨ä¸»æ–‡ä»¶
â”œâ”€â”€ package.json                # é¡¹ç›®é…ç½®å’Œä¾èµ–
â”œâ”€â”€ package-lock.json           # ä¾èµ–é”å®šæ–‡ä»¶
â”œâ”€â”€ mcp-config-example.json     # Cursor é…ç½®ç¤ºä¾‹
â”œâ”€â”€ README.md                   # ç”¨æˆ·æ–‡æ¡£ï¼ˆé¢å‘æœ€ç»ˆç”¨æˆ·ï¼‰
â”œâ”€â”€ DEVELOPER.md                # å¼€å‘è€…æ–‡æ¡£ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”œâ”€â”€ PUBLISH.md                  # å‘å¸ƒæŒ‡å—
â”œâ”€â”€ publish.sh                  # å‘å¸ƒè„šæœ¬ï¼ˆå¯é€‰ï¼‰
â”œâ”€â”€ .npmignore                  # npm å‘å¸ƒæ’é™¤æ–‡ä»¶
â”œâ”€â”€ .gitignore                  # Git å¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ api.json                    # Baklib API å®Œæ•´æ–‡æ¡£ï¼ˆä»…å¼€å‘ç”¨ï¼Œä¸å‘å¸ƒï¼‰
â”œâ”€â”€ test-all-apis.js            # å®Œæ•´ API æµ‹è¯•è„šæœ¬ï¼ˆä»…å¼€å‘ç”¨ï¼Œä¸å‘å¸ƒï¼‰
â”œâ”€â”€ test-upload-*.js            # å„ç§ä¸Šä¼ æµ‹è¯•è„šæœ¬ï¼ˆä»…å¼€å‘ç”¨ï¼Œä¸å‘å¸ƒï¼‰
â””â”€â”€ node_modules/               # ä¾èµ–åŒ…
```

## ğŸ“¦ ä¾èµ–è¯´æ˜

- **@modelcontextprotocol/sdk**ï¼šMCP SDKï¼Œç”¨äºå®ç° MCP åè®®
- **form-data**ï¼šç”¨äºåˆ›å»º multipart/form-data è¯·æ±‚
- **node-fetch**ï¼šç”¨äºå‘é€ HTTP è¯·æ±‚
- **dotenv**ï¼šç”¨äºåŠ è½½ç¯å¢ƒå˜é‡

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
# æµ‹è¯•æ‰€æœ‰ API æ¥å£
node test-all-apis.js your-api-token
```

### æµ‹è¯•å•ä¸ªåŠŸèƒ½

```bash
# æµ‹è¯•æ–‡ä»¶ä¸Šä¼ ï¼ˆJSON API æ ¼å¼ï¼‰
node test-upload-jsonapi.js file-path your-api-token

# æµ‹è¯•æ–‡ä»¶ä¸Šä¼ ï¼ˆåŸç”Ÿæ ¼å¼ï¼‰
node test-upload-native.js file-path your-api-token

# æµ‹è¯•æ–‡ä»¶ä¸Šä¼ ï¼ˆåŸºç¡€æ ¼å¼ï¼‰
node test-upload.js file-path
```

### æµ‹è¯•æ­¥éª¤

1. **é…ç½®ç¯å¢ƒå˜é‡**ï¼šåˆ›å»º `.env` æ–‡ä»¶å¹¶è®¾ç½® `BAKLIB_TOKEN`
2. **è¿è¡Œæµ‹è¯•**ï¼šä½¿ç”¨ä¸Šè¿°æµ‹è¯•è„šæœ¬
3. **éªŒè¯ç»“æœ**ï¼šæ£€æŸ¥è¿”å›çš„å“åº”å’Œæ–‡ä»¶æ˜¯å¦æˆåŠŸä¸Šä¼ 

### è°ƒè¯•æŠ€å·§

æœåŠ¡å™¨ä¼šå°†è°ƒè¯•ä¿¡æ¯è¾“å‡ºåˆ° stderrï¼š

```bash
# ç›´æ¥è¿è¡ŒæŸ¥çœ‹è¾“å‡º
node index.js 2>&1 | tee debug.log

# æŸ¥çœ‹ Cursor çš„ MCP æ—¥å¿—
# åœ¨ Cursor ä¸­æŸ¥çœ‹ MCP è¿æ¥çŠ¶æ€å’Œå·¥å…·è°ƒç”¨çš„é”™è¯¯ä¿¡æ¯
```

### å¸¸è§æµ‹è¯•é—®é¢˜

1. **API è®¤è¯å¤±è´¥**ï¼šæ£€æŸ¥ `BAKLIB_TOKEN` æ˜¯å¦æ­£ç¡®
2. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**ï¼šæ£€æŸ¥æ–‡ä»¶è·¯å¾„å’Œæƒé™
3. **API ç«¯ç‚¹é”™è¯¯**ï¼šç¡®è®¤ä½¿ç”¨çš„æ˜¯æ­£ç¡®çš„ API ç«¯ç‚¹

## ğŸ“ ä»£ç ç»“æ„

### ä¸»è¦å‡½æ•°

- `makeApiRequest()`: é€šç”¨ API è¯·æ±‚å‡½æ•°
- `uploadFileToBaklib()`: æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
- `dam_*()`: èµ„æºåº“ç›¸å…³å‡½æ•°
- `kb_*()`: çŸ¥è¯†åº“ç›¸å…³å‡½æ•°

### API ç«¯ç‚¹

æ‰€æœ‰ API ç«¯ç‚¹åŸºäº `BAKLIB_API_BASE` ç¯å¢ƒå˜é‡ï¼ˆé»˜è®¤ï¼š`https://open.baklib.com/api/v1`ï¼‰ï¼š

- èµ„æºåº“ï¼š`/dam/files`, `/dam/entities`
- çŸ¥è¯†åº“ï¼š`/kb/spaces`, `/kb/spaces/{space_id}/articles`

**æ³¨æ„**ï¼šç§æœ‰åŒ–éƒ¨ç½²ç”¨æˆ·å¯ä»¥é€šè¿‡è®¾ç½® `BAKLIB_API_BASE` ç¯å¢ƒå˜é‡æ¥é…ç½®è‡ªå·±çš„ API åœ°å€ã€‚

## ğŸ“‹ API æ¥å£å®ç°çŠ¶æ€

### èµ„æºåº“ï¼ˆDAMï¼‰æ¥å£

| API ç«¯ç‚¹ | HTTP æ–¹æ³• | åŠŸèƒ½æè¿° | MCP å·¥å…· | çŠ¶æ€ |
|---------|----------|---------|---------|------|
| `/dam/files` | POST | ä¸Šä¼ æ–‡ä»¶åˆ°èµ„æºåº“ | `dam_upload_entity` | âœ… å·²å®ç° |
| `/dam/entities` | GET | è·å–èµ„æºåº“åˆ—è¡¨ | `dam_list_entities` | âœ… å·²å®ç° |
| `/dam/entities/{entity_id}` | GET | è·å–èµ„æºè¯¦æƒ… | `dam_get_entity` | âœ… å·²å®ç° |
| `/dam/entities/{entity_id}` | DELETE | åˆ é™¤èµ„æº | `dam_delete_entity` | âœ… å·²å®ç° |
| `/dam/files/{entity_id}` | PATCH | æ›´æ–°æ–‡ä»¶å…ƒæ•°æ® | `dam_update_entity` | âœ… å·²å®ç° |
| `/dam/entities/{entity_id}/urls` | POST | è·å–å¸¦è¿‡æœŸæ—¶é—´çš„èµ„æº URL | - | â³ å¾…å®ç° |
| `/dam/fragments` | POST | æ·»åŠ çŸ¥è¯†ç‰‡æ®µ | - | â³ å¾…å®ç° |
| `/dam/fragments/{entity_id}` | PATCH | æ›´æ–°çŸ¥è¯†ç‰‡æ®µ | - | â³ å¾…å®ç° |
| `/dam/links` | POST | æ·»åŠ ç½‘å€èµ„æº | - | â³ å¾…å®ç° |
| `/dam/links/{entity_id}` | PATCH | æ›´æ–°ç½‘å€èµ„æº | - | â³ å¾…å®ç° |
| `/dam/collections` | GET | è·å–èµ„æºåº“é›†åˆåˆ—è¡¨ | - | â³ å¾…å®ç° |

**å®ç°è¿›åº¦**ï¼š5/11 (45.5%)

### çŸ¥è¯†åº“ï¼ˆKBï¼‰æ¥å£

| API ç«¯ç‚¹ | HTTP æ–¹æ³• | åŠŸèƒ½æè¿° | MCP å·¥å…· | çŠ¶æ€ |
|---------|----------|---------|---------|------|
| `/kb/spaces` | GET | è·å–çŸ¥è¯†åº“åˆ—è¡¨ | `kb_list_knowledge_bases` | âœ… å·²å®ç° |
| `/kb/spaces` | POST | åˆ›å»ºçŸ¥è¯†åº“ | - | â³ å¾…å®ç° |
| `/kb/spaces/{space_id}` | GET | è·å–çŸ¥è¯†åº“è¯¦æƒ… | `kb_get_knowledge_base` | âœ… å·²å®ç° |
| `/kb/spaces/{space_id}` | PATCH | æ›´æ–°çŸ¥è¯†åº“ | - | â³ å¾…å®ç° |
| `/kb/spaces/{space_id}` | DELETE | åˆ é™¤çŸ¥è¯†åº“ | - | â³ å¾…å®ç° |
| `/kb/spaces/{space_id}/articles` | GET | è·å–æ–‡ç« åˆ—è¡¨ | `kb_list_articles` | âœ… å·²å®ç° |
| `/kb/spaces/{space_id}/articles` | POST | åˆ›å»ºæ–‡ç«  | `kb_create_article` | âœ… å·²å®ç° |
| `/kb/spaces/{space_id}/articles/{article_id}` | GET | è·å–æ–‡ç« è¯¦æƒ… | `kb_get_article` | âœ… å·²å®ç° |
| `/kb/spaces/{space_id}/articles/{article_id}` | PATCH | æ›´æ–°æ–‡ç«  | `kb_update_article` | âœ… å·²å®ç° |
| `/kb/spaces/{space_id}/articles/{article_id}` | DELETE | åˆ é™¤æ–‡ç«  | `kb_delete_article` | âœ… å·²å®ç° |

**å®ç°è¿›åº¦**ï¼š7/10 (70%)

### å…¶ä»–æ¥å£

ä»¥ä¸‹æ¥å£æš‚ä¸è®¡åˆ’å®ç°ï¼ˆæ ¹æ®é¡¹ç›®éœ€æ±‚å†³å®šï¼‰ï¼š

| API ç«¯ç‚¹ | HTTP æ–¹æ³• | åŠŸèƒ½æè¿° | çŠ¶æ€ |
|---------|----------|---------|------|
| `/organizations/departments` | GET/POST/PATCH/DELETE | éƒ¨é—¨ç®¡ç† | âŒ ä¸å®ç° |
| `/users` | GET/PUT | ç”¨æˆ·ç®¡ç† | âŒ ä¸å®ç° |
| `/organizations/groups` | GET/POST/PATCH/DELETE | å›¢é˜Ÿç®¡ç† | âŒ ä¸å®ç° |
| `/organizations/employees` | GET/POST/PATCH/DELETE | é›‡å‘˜ç®¡ç† | âŒ ä¸å®ç° |
| `/sites` | GET/POST/PATCH | ç«™ç‚¹ç®¡ç† | âŒ ä¸å®ç° |
| `/sites/{site_id}/pages` | GET/POST/PATCH/DELETE | ç«™ç‚¹é¡µé¢ç®¡ç† | âŒ ä¸å®ç° |
| `/sites/{site_id}/tags` | GET/POST/DELETE | ç«™ç‚¹æ ‡ç­¾ç®¡ç† | âŒ ä¸å®ç° |
| `/themes` | GET | æ¨¡æ¿åˆ—è¡¨ | âŒ ä¸å®ç° |
| `/integrations` | GET/POST/PATCH/DELETE | ç¬¬ä¸‰æ–¹åŠŸèƒ½é›†æˆ | âŒ ä¸å®ç° |
| `/members` | GET/POST/PATCH | ç»„ç»‡æˆå‘˜ç®¡ç† | âŒ ä¸å®ç° |

### å®ç°çŠ¶æ€è¯´æ˜

- âœ… **å·²å®ç°**ï¼šåŠŸèƒ½å·²å®Œæˆå¹¶é€šè¿‡æµ‹è¯•
- â³ **å¾…å®ç°**ï¼šè®¡åˆ’å®ç°ä½†å°šæœªå®Œæˆ
- âŒ **ä¸å®ç°**ï¼šæ ¹æ®é¡¹ç›®éœ€æ±‚ï¼Œæš‚ä¸è®¡åˆ’å®ç°

### å®ç°ä¼˜å…ˆçº§

#### ç¬¬ä¸€é˜¶æ®µï¼ˆå·²å®Œæˆï¼‰âœ…
- èµ„æºåº“æ ¸å¿ƒåŠŸèƒ½ï¼šæ–‡ä»¶ä¸Šä¼ ã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤
- çŸ¥è¯†åº“æ ¸å¿ƒåŠŸèƒ½ï¼šæ–‡ç« åˆ›å»ºã€æŸ¥è¯¢ã€æ›´æ–°ã€åˆ é™¤ï¼ŒçŸ¥è¯†åº“åˆ—è¡¨

#### ç¬¬äºŒé˜¶æ®µï¼ˆè®¡åˆ’ä¸­ï¼‰â³
- èµ„æºåº“æ‰©å±•åŠŸèƒ½ï¼š
  - è·å–å¸¦è¿‡æœŸæ—¶é—´çš„èµ„æº URL (`/dam/entities/{entity_id}/urls`)
  - çŸ¥è¯†ç‰‡æ®µç®¡ç† (`/dam/fragments`, `/dam/fragments/{entity_id}`)
  - ç½‘å€èµ„æºç®¡ç† (`/dam/links`, `/dam/links/{entity_id}`)
  - èµ„æºåº“é›†åˆç®¡ç† (`/dam/collections`)
- çŸ¥è¯†åº“æ‰©å±•åŠŸèƒ½ï¼š
  - çŸ¥è¯†åº“åˆ›å»º (`/kb/spaces` POST)
  - çŸ¥è¯†åº“æ›´æ–° (`/kb/spaces/{space_id}` PATCH)
  - çŸ¥è¯†åº“åˆ é™¤ (`/kb/spaces/{space_id}` DELETE)

### æ€»ä½“å®ç°è¿›åº¦

- **èµ„æºåº“ï¼ˆDAMï¼‰**ï¼š5/11 æ¥å£å·²å®ç° (45.5%)
- **çŸ¥è¯†åº“ï¼ˆKBï¼‰**ï¼š7/10 æ¥å£å·²å®ç° (70%)
- **æ€»è®¡**ï¼š12/21 æ¥å£å·²å®ç° (57.1%)

### æ¥å£åˆ†ç±»è¯´æ˜

#### å·²å®ç°æ¥å£ âœ…
æ‰€æœ‰å·²å®ç°çš„æ¥å£éƒ½ç»è¿‡äº†å®Œæ•´æµ‹è¯•ï¼ŒåŠŸèƒ½æ­£å¸¸ã€‚

#### å¾…å®ç°æ¥å£ â³
è¿™äº›æ¥å£åœ¨ API æ–‡æ¡£ä¸­å­˜åœ¨ï¼Œä½†å°šæœªåœ¨ MCP Server ä¸­å®ç°ã€‚å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚æŒ‰ä¼˜å…ˆçº§å®ç°ã€‚

#### ä¸å®ç°æ¥å£ âŒ
è¿™äº›æ¥å£å±äº Baklib çš„å…¶ä»–åŠŸèƒ½æ¨¡å—ï¼ˆå¦‚ç»„ç»‡ç®¡ç†ã€ç«™ç‚¹ç®¡ç†ç­‰ï¼‰ï¼Œä¸åœ¨å½“å‰ MCP Server çš„èŒƒå›´å†…ã€‚å¦‚æœæœªæ¥æœ‰éœ€æ±‚ï¼Œå¯ä»¥å•ç‹¬å®ç°ã€‚

## ğŸ”„ å¼€å‘æµç¨‹

### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨ `index.js` ä¸­å®ç°æ–°åŠŸèƒ½å‡½æ•°
2. åœ¨ `ListToolsRequestSchema` ä¸­æ·»åŠ å·¥å…·å®šä¹‰
3. åœ¨ `CallToolRequestSchema` ä¸­æ·»åŠ å·¥å…·å¤„ç†é€»è¾‘
4. æ›´æ–° `README.md` æ·»åŠ ä½¿ç”¨è¯´æ˜
5. ç¼–å†™æµ‹è¯•å¹¶éªŒè¯

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ ES6+ è¯­æ³•
- ä½¿ç”¨ async/await å¤„ç†å¼‚æ­¥æ“ä½œ
- æ·»åŠ é€‚å½“çš„é”™è¯¯å¤„ç†
- æ·»åŠ æ³¨é‡Šè¯´æ˜å…³é”®é€»è¾‘

## ğŸ“¦ å‘å¸ƒæµç¨‹

å‚è€ƒ [PUBLISH.md](./PUBLISH.md) äº†è§£è¯¦ç»†çš„å‘å¸ƒæµç¨‹ã€‚

### å¿«é€Ÿå‘å¸ƒ

```bash
# æ›´æ–°ç‰ˆæœ¬å·
npm version patch  # æˆ– minor, major

# å‘å¸ƒ
npm publish --access public
```

## ğŸ› è°ƒè¯•

### æŸ¥çœ‹æ—¥å¿—

æœåŠ¡å™¨ä¼šå°†è°ƒè¯•ä¿¡æ¯è¾“å‡ºåˆ° stderrï¼š

```bash
node index.js 2>&1 | tee debug.log
```

### å¸¸è§é—®é¢˜

1. **ä¾èµ–å®‰è£…å¤±è´¥**ï¼šç¡®ä¿ Node.js ç‰ˆæœ¬ >= 18.0.0
2. **API è¯·æ±‚å¤±è´¥**ï¼šæ£€æŸ¥ç½‘ç»œè¿æ¥å’Œ token é…ç½®
3. **æ–‡ä»¶ä¸Šä¼ å¤±è´¥**ï¼šæ£€æŸ¥æ–‡ä»¶è·¯å¾„å’Œæƒé™

## ğŸ“š ç›¸å…³èµ„æº

- [Baklib API æ–‡æ¡£](https://dev.baklib.cn/api)
- [MCP åè®®æ–‡æ¡£](https://modelcontextprotocol.io)
- [npm åŒ…é¡µé¢](https://www.npmjs.com/package/@baklib/baklib-mcp-server)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

